# Systemd User Timer for Topgrade
# Purpose: Schedule monthly system maintenance using topgrade
# Template Variables: Uses chezmoi template system for user-specific configuration

{{ if eq .osId "linux-arch" }}
[Unit]
Description=Monthly Topgrade System Maintenance Timer
Documentation=https://github.com/topgrade-rs/topgrade
Requires=topgrade.service

[Timer]
# Run on the first Sunday of each month at 10:00 AM
OnCalendar=Sun *-*-01..07 10:00:00
# If the system was off during the scheduled time, run when it comes back online
Persistent=true
# Add some randomization to avoid all systems updating at exactly the same time
RandomizedDelaySec=1800
# Ensure the timer is accurate
AccuracySec=1h

[Install]
WantedBy=timers.target

{{ else }}
# Timer disabled on unsupported systems
[Unit]
Description=Monthly Topgrade System Maintenance Timer (Disabled - Unsupported OS)

[Timer]
# Disabled timer
OnCalendar=

[Install]
WantedBy=timers.target

{{ end }}
