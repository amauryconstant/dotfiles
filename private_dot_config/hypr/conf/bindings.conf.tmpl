# ============================================================================
# Keybindings Configuration
# ============================================================================
# Keyboard and mouse shortcuts for Hyprland.
# Documentation: https://wiki.hyprland.org/Configuring/Binds/
#
# SYNTAX:
# bind  = MODIFIERS, KEY, DISPATCHER, PARAMS
# bindm = MODIFIERS, MOUSE_BUTTON, DISPATCHER
#
# MODIFIERS: SUPER, CTRL, ALT, SHIFT (combine with spaces)
# KEY:       Key name or mouse button (see: xev or wev)
# DISPATCHER: Action to perform (exec, workspace, killactive, etc.)
# PARAMS:    Parameters for the dispatcher
#
# SPECIAL BINDINGS:
# - bindr  = Release bind (triggers on key release)
# - binde  = Repeat bind (repeats while key held)
# - bindl  = Locked bind (works even when screen is locked)
# - bindm  = Mouse bind (for drag operations)
# ============================================================================

# Modifier key: SUPER (Windows key)
# Change to ALT for Alt-based shortcuts
$mod = SUPER

# ============================================================================
# Application Launchers
# ============================================================================

# Terminal: Super + Return
# Enhanced to preserve current working directory
bind = $mod, Return, exec, {{ .globals.applications.terminal }} --working-directory=$(~/.local/lib/scripts/terminal/terminal-cwd.sh)

# Application launcher: Super + D
# Wofi shows desktop applications from .desktop files
bind = $mod, D, exec, wofi --show drun

# File manager: Super + E (GUI)
# Uses launch-or-focus for single-instance behavior
bind = $mod, E, exec, ~/.local/lib/scripts/desktop/launch-or-focus.sh thunar

# Terminal file manager: Super + Shift + E (Yazi)
bind = $mod SHIFT, E, exec, {{ .globals.applications.terminal }} -e yazi

# Firefox: Super + W (Web browser)
bind = $mod, W, exec, firefox
bind = $mod SHIFT, W, exec, firefox --private-window

# VS Code: Super + O (Visual editor)
bind = $mod, O, exec, ~/.local/lib/scripts/desktop/launch-or-focus.sh code
bind = $mod SHIFT, O, exec, code "$(~/.local/lib/scripts/terminal/terminal-cwd.sh)"

# Neovim: Super + K (Terminal editor)
bind = $mod, K, exec, {{ .globals.applications.terminal }} -e nvim
bind = $mod SHIFT, K, exec, {{ .globals.applications.terminal }} -e nvim "$(~/.local/lib/scripts/terminal/terminal-cwd.sh)"

# Clipboard history: Super + C
# Shows clipboard history via wofi, select to copy back to clipboard
bind = $mod, C, exec, cliphist list | wofi --dmenu | cliphist decode | wl-copy

# ============================================================================
# Window Management
# ============================================================================

# Close window: Super + Q
bind = $mod, Q, killactive

# Exit Hyprland: Super + M
# REMOVED - Dangerous single-key exit without confirmation
# Use Super + Shift + Q for safe power menu (wlogout) instead
# Or use Super + Space → System menu (when menu system is implemented)
# bind = $mod, M, exit

# Toggle floating: Super + V
# Switches window between tiling and floating mode
bind = $mod, V, togglefloating

# Toggle fullscreen: Super + F
bind = $mod, F, fullscreen, 0
# Maximize window: Super + Shift + F  
bind = $mod SHIFT, F, fullscreen, 1

# Pseudotile: Super + P
# Makes floating window behave like tiled (dwindle layout specific)
bind = $mod, P, pseudo

# Picture-in-picture mode: Super + Shift + P
# Float, resize to 30%, center, pin, and raise to top
bind = $mod SHIFT, P, exec, ~/.local/lib/scripts/desktop/window-pop.sh

# Toggle split: Super + J
# Switches split direction between horizontal/vertical (dwindle layout)
bind = $mod, J, togglesplit

# ============================================================================
# Focus Navigation
# ============================================================================

# Move focus with arrow keys: Super + Arrows
bind = $mod, left, movefocus, l   # Focus left window
bind = $mod, right, movefocus, r  # Focus right window
bind = $mod, up, movefocus, u     # Focus upper window
bind = $mod, down, movefocus, d   # Focus lower window

# Move focus with vim keys: Super + H/J/K/L
bind = $mod, h, movefocus, l  # Focus left (vim-style)
bind = $mod, l, movefocus, r  # Focus right (vim-style)
bind = $mod, k, movefocus, u  # Focus up (vim-style)
bind = $mod, j, movefocus, d  # Focus down (vim-style)

# Move windows with arrow keys: Super + Shift + Arrows
bind = $mod SHIFT, left, movewindow, l   # Move window left
bind = $mod SHIFT, right, movewindow, r  # Move window right
bind = $mod SHIFT, up, movewindow, u     # Move window up
bind = $mod SHIFT, down, movewindow, d   # Move window down

# Resize windows with Ctrl: Super + Ctrl + Arrows
bind = $mod CTRL, left, resizeactive, -20 0   # Shrink width
bind = $mod CTRL, right, resizeactive, 20 0   # Expand width
bind = $mod CTRL, up, resizeactive, 0 -20     # Shrink height
bind = $mod CTRL, down, resizeactive, 0 20    # Expand height

# ============================================================================
# Workspace Navigation
# ============================================================================

# Switch to workspace: Super + [1-0]
bind = $mod, 1, workspace, 1
bind = $mod, 2, workspace, 2
bind = $mod, 3, workspace, 3
bind = $mod, 4, workspace, 4
bind = $mod, 5, workspace, 5
bind = $mod, 6, workspace, 6
bind = $mod, 7, workspace, 7
bind = $mod, 8, workspace, 8
bind = $mod, 9, workspace, 9
bind = $mod, 0, workspace, 10

# Cycle through workspaces: Super + Mouse Wheel
bind = $mod, mouse_down, workspace, e+1  # Next workspace
bind = $mod, mouse_up, workspace, e-1    # Previous workspace

# Cycle through workspaces with keyboard:
bind = $mod, Tab, workspace, e+1         # Next workspace
bind = $mod SHIFT, Tab, workspace, e-1   # Previous workspace

# Go to previous workspace (uncomment to enable):
# bind = $mod, grave, workspace, previous  # Super + ` (backtick)

# ============================================================================
# Move Windows
# ============================================================================

# Move window to workspace: Super + Shift + [1-0]
# Window moves but you stay on current workspace
bind = $mod SHIFT, 1, movetoworkspace, 1
bind = $mod SHIFT, 2, movetoworkspace, 2
bind = $mod SHIFT, 3, movetoworkspace, 3
bind = $mod SHIFT, 4, movetoworkspace, 4
bind = $mod SHIFT, 5, movetoworkspace, 5
bind = $mod SHIFT, 6, movetoworkspace, 6
bind = $mod SHIFT, 7, movetoworkspace, 7
bind = $mod SHIFT, 8, movetoworkspace, 8
bind = $mod SHIFT, 9, movetoworkspace, 9
bind = $mod SHIFT, 10, movetoworkspace, 10

# Move window silently (without switching workspace):
# bind = $mod SHIFT, 1, movetoworkspacesilent, 1

# Move and follow window to workspace:
# bind = $mod CTRL, 1, movetoworkspace, 1
# bind = $mod CTRL, 1, workspace, 1

# ============================================================================
# Mouse Bindings
# ============================================================================

# Move window: Super + Left Mouse Button (drag)
# mouse:272 = Left mouse button
bindm = $mod, mouse:272, movewindow

# Resize window: Super + Right Mouse Button (drag)
# mouse:273 = Right mouse button
bindm = $mod, mouse:273, resizewindow

# ============================================================================
# Screenshots (Satty annotation editor integration)
# ============================================================================

# Smart screenshot with Satty editor: Print Screen
# Auto-snaps to window if selection is tiny, opens annotation editor
bind = , Print, exec, ~/.local/lib/scripts/media/screenshot.sh smart

# Quick screenshot to clipboard: Shift + Print Screen
# Bypasses editor, direct to clipboard for speed
bind = SHIFT, Print, exec, ~/.local/lib/scripts/media/screenshot.sh smart clipboard

# Color picker: Super + Print Screen
# Pick color and copy hex code to clipboard
bind = $mod, Print, exec, pkill hyprpicker || hyprpicker -a

# Fullscreen screenshot with editor: Super + Shift + Print Screen
bind = $mod SHIFT, Print, exec, ~/.local/lib/scripts/media/screenshot.sh fullscreen

# ============================================================================
# Media Keys
# ============================================================================

# Volume control using pamixer
# Note: Install pamixer or replace with pactl/amixer
bind = , XF86AudioRaiseVolume, exec, pamixer -i 5  # Volume up 5%
bind = , XF86AudioLowerVolume, exec, pamixer -d 5  # Volume down 5%
bind = , XF86AudioMute, exec, pamixer -t           # Toggle mute

# Alternative with pactl (PulseAudio/PipeWire):
# bind = , XF86AudioRaiseVolume, exec, pactl set-sink-volume @DEFAULT_SINK@ +5%
# bind = , XF86AudioLowerVolume, exec, pactl set-sink-volume @DEFAULT_SINK@ -5%
# bind = , XF86AudioMute, exec, pactl set-sink-mute @DEFAULT_SINK@ toggle

# Brightness control (laptop)
bind = , XF86MonBrightnessUp, exec, brightnessctl set +10%
bind = , XF86MonBrightnessDown, exec, brightnessctl set 10%-

# Media playback control using playerctl
# Controls any MPRIS-compatible media player (Spotify, Firefox, mpv, etc.)
bind = , XF86AudioPlay, exec, playerctl play-pause
bind = , XF86AudioPause, exec, playerctl pause
bind = , XF86AudioNext, exec, playerctl next
bind = , XF86AudioPrev, exec, playerctl previous

# ============================================================================
# Window Resizing (Resize Mode)
# ============================================================================
# Uncomment for resize mode (like i3)
#
# bind = $mod, R, submap, resize  # Enter resize mode
#
# submap = resize
# binde = , right, resizeactive, 10 0
# binde = , left, resizeactive, -10 0
# binde = , up, resizeactive, 0 -10
# binde = , down, resizeactive, 0 10
# bind = , escape, submap, reset  # Exit resize mode
# bind = , return, submap, reset
# submap = reset
# ============================================================================

# ============================================================================
# Special Workspace (Scratchpad)
# ============================================================================
# Scratchpad: Hidden workspace for quick-access applications
# Useful for terminal, calculator, notes, system monitor, etc.
# Super+S toggles visibility, Super+Shift+S moves windows to scratchpad
bind = $mod, S, togglespecialworkspace, magic     # Toggle scratchpad
bind = $mod SHIFT, S, movetoworkspace, special:magic  # Move to scratchpad
# ============================================================================

# ============================================================================
# Additional Useful Bindings (uncomment as needed)
# ============================================================================

# Reload Hyprland configuration:
# bind = $mod SHIFT, R, exec, hyprctl reload

# Lock screen: Super + L
bind = $mod, L, exec, hyprlock

# Power menu: Super + Shift + Q
bind = $mod SHIFT, Q, exec, ~/.local/lib/scripts/desktop/wlogout.sh

# Keybinding cheatsheet: Super + /
# Displays all active keybindings dynamically from hyprctl
bind = $mod, slash, exec, ~/.local/lib/scripts/desktop/keybindings.sh

# Monitor management: Super + M
# Cycle through monitor configurations
bind = $mod, M, exec, ~/.local/lib/scripts/desktop/monitor-switch.sh
bind = $mod SHIFT, M, exec, ~/.local/lib/scripts/desktop/monitor-mirror.sh

# Utilities menu: Super + U
# Quick access to system utilities and settings
bind = $mod, U, exec, ~/.local/lib/scripts/user-interface/utilities-menu.sh
bind = $mod SHIFT, U, exec, ~/.local/lib/scripts/desktop/system-settings.sh

# ============================================================================
# Enhanced Desktop Utilities (Omarchy-inspired)
# ============================================================================

# Screen recording: Super + R (toggle on/off)
# Super + Shift + R for recording with audio
bind = $mod, R, exec, ~/.local/lib/scripts/desktop/screenrecord.sh
bind = $mod SHIFT, R, exec, ~/.local/lib/scripts/desktop/screenrecord.sh --with-audio

# Gap toggle: Super + G
# Toggle gaps/borders for presentation/immersive mode
bind = $mod, G, exec, ~/.local/lib/scripts/desktop/workspace-gaps-toggle.sh
bind = $mod SHIFT, G, exec, ~/.local/lib/scripts/desktop/workspace-gaps-reset.sh

# Audio output switcher: Super + A
# Cycle through available audio outputs
bind = $mod, A, exec, ~/.local/lib/scripts/desktop/audio-switch.sh
bind = $mod SHIFT, A, exec, pavucontrol

# Nightlight toggle: Super + N
# Toggle blue light filter (6000K ↔ 4000K)
bind = $mod, N, exec, ~/.local/lib/scripts/desktop/nightlight-toggle.sh
bind = $mod SHIFT, N, exec, ~/.local/lib/scripts/desktop/nightlight-config.sh

# Theme management
# Toggle between light/dark theme variant (Shift+Y)
# Open theme menu (Shift+Ctrl+Space)
bind = $mod SHIFT, Y, exec, darkman toggle
bind = $mod SHIFT CTRL, SPACE, exec, ~/.local/lib/scripts/user-interface/theme-menu.sh

# Idle lock toggle: Super + I
# Disable automatic screen locking (presentation mode)
bind = $mod, I, exec, ~/.local/lib/scripts/desktop/idle-toggle.sh
bind = $mod SHIFT, I, exec, ~/.local/lib/scripts/desktop/immediate-lock.sh

# Waybar toggle: Super + B
# Show/hide status bar for distraction-free mode
bind = $mod, B, exec, ~/.local/lib/scripts/desktop/waybar-toggle.sh
bind = $mod SHIFT, B, exec, ~/.local/lib/scripts/desktop/waybar-style.sh

# System monitor: Super + T
# Uses launch-or-focus for single-instance btop
bind = $mod, T, exec, ~/.local/lib/scripts/desktop/launch-or-focus.sh btop "{{ .globals.applications.terminal }} -e btop"
bind = $mod SHIFT, T, exec, {{ .globals.applications.terminal }} -e htop

# ============================================================================
# Hierarchical Menu System (Omarchy-inspired)
# ============================================================================

# Main system menu: Super + Space
# Provides access to all system functions (Apps, Learn, Trigger, Style, Setup, Install, Remove, Update, About, System)
bind = $mod, Space, exec, ~/.local/lib/scripts/user-interface/system-menu.sh

# Quick access to submenus (optional shortcuts)
bind = $mod ALT, S, exec, ~/.local/lib/scripts/user-interface/menu-system.sh    # System (power menu)
bind = $mod ALT, T, exec, ~/.local/lib/scripts/user-interface/menu-trigger.sh   # Trigger (capture/toggle)

# ============================================================================
# Additional Useful Bindings Reference
# ============================================================================

# ============================================================================
# Configuration Complete
# ============================================================================
# For dispatcher reference, see: https://wiki.hyprland.org/Configuring/Binds/
# ============================================================================
