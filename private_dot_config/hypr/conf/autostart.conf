# ============================================================================
# Autostart Applications
# ============================================================================
# Applications and services to launch when Hyprland starts.
#
# DIRECTIVES:
# - exec-once  : Run once at startup (won't run again on config reload)
# - exec       : Run every time config is reloaded (use sparingly)
#
# WHEN TO USE exec-once:
# - Status bars, notification daemons, background services
# - Applications that should only have one instance
#
# WHEN TO USE exec:
# - Wallpaper setters that need to reapply on reload
# - One-time commands that are safe to run multiple times
# ============================================================================

# Waybar - Status bar showing workspaces, system info, and tray icons
# Location: ~/.config/waybar/config and ~/.config/waybar/style.css
exec-once = waybar

# swww - Wayland wallpaper daemon with smooth transitions
# Manages desktop wallpapers with animated transitions between images
# Controlled via swww CLI commands and automated by wallpaper-cycle.timer
exec-once = swww-daemon

# D-Bus activation environment update
# Required for proper Wayland integration with applications and screen sharing
# Updates both D-Bus session and systemd user session with Wayland display info
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP

# Nextcloud - Cloud sync client running in background
# Preserves your existing sync workflow from KDE setup
# --background flag prevents window from showing at startup
exec-once = nextcloud --background

# Gnome Keyring - Secret storage for WiFi passwords, SSH keys, GPG keys
# Required for nmtui and NetworkManager to store/retrieve network credentials
exec-once = eval $(/usr/bin/gnome-keyring-daemon --start --components=gpg,pkcs11,secrets,ssh)

# Polkit Authentication Agent - Required for GUI privilege elevation
# Using polkit-gnome (stable) instead of hyprpolkitagent (crashes with Qt platform plugin issues)
# Launched directly to ensure WAYLAND_DISPLAY is available
exec-once = /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1

# Clipboard History Manager - Stores clipboard items for later retrieval
# Watches clipboard changes and stores them in history database
exec-once = wl-paste --watch ~/.local/lib/scripts/media/clipboard-store

# Idle Management Daemon - Handles screen locking and power management
# Locks screen after 5 min, turns off displays after 10 min, suspends after 15 min (laptop only)
exec-once = hypridle

# Session restore prompt - Ask user to restore previous session on login
# 5 second delay ensures Hyprland is fully initialized before prompting
exec-once = sleep 5 && ~/.local/lib/scripts/desktop/session-prompt

# Session start hook - Notify user hooks that a new session has started
exec-once = sleep 5 && ~/.local/lib/scripts/core/hook-runner session-start

# Hyprpm - Reload plugins at startup
# Required for plugins to load automatically
exec-once = hyprpm reload -n

# COMMON ADDITIONS (uncomment as needed):
# exec-once = blueman-applet             # Bluetooth tray icon

# ============================================================================
# SERVICE REFERENCE (Run via systemd instead of exec-once)
# ============================================================================
# These services are started via systemd user services for better reliability:
#
# SwayNotificationCenter - Notification daemon
#   Started automatically via D-Bus activation (org.freedesktop.Notifications)
#   DO NOT add exec-once = swaync â€” conflicts with SystemdService= in D-Bus activation file
#   Status: systemctl --user status swaync
#
# HyprDynamicMonitors - Automatic monitor profile switching
#   Enable: systemctl --user enable hyprdynamicmonitors-prepare.service
#   Status: systemctl --user status hyprdynamicmonitors
#   Logs: journalctl --user -u hyprdynamicmonitors
#
# hyprwhenthen - Event-driven window automation
#   Enable: systemctl --user enable hyprwhenthen.service
#   Status: systemctl --user status hyprwhenthen
#   Logs: journalctl --user -u hyprwhenthen
#
# If needed, you can run them via exec-once instead (not recommended):
# exec-once = hyprdynamicmonitors run
# exec-once = hyprwhenthen run
# ============================================================================
