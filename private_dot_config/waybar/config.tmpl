// ============================================================================
// Waybar Configuration
// ============================================================================
// Status bar configuration for Hyprland with oksolar color scheme.
// Documentation: https://github.com/Alexays/Waybar/wiki
//
// This file uses JSON5 format (JSON with comments and trailing commas allowed)
// Chezmoi template processing: Uses {{"{{"}} {{"}}"}} for accessing oksolar colors
//
// FILE STRUCTURE:
// - Bar settings (layer, position, height)
// - Module layout (left, center, right)
// - Module configurations (workspaces, clock, system info, etc.)
//
// To find module names and properties: man waybar-MODULE (e.g., man waybar-clock)
// To reload waybar: killall -SIGUSR2 waybar
// ============================================================================

{
  // --------------------------------------------------------------------------
  // Bar Settings
  // --------------------------------------------------------------------------
  // Layer: Z-order relative to windows
  //   "top"     = Above windows (default)
  //   "bottom"  = Below windows
  //   "overlay" = Above fullscreen windows
  "layer": "top",

  // Position: Which screen edge
  //   Options: "top", "bottom", "left", "right"
  "position": "top",

  // Height: Bar height in pixels (0 = auto-size)
  "height": 30,

  // Spacing: Gap between modules in pixels
  "spacing": 4,

  // Margin: Space around the bar (uncomment to add):
  // "margin": "5 10 0 10",  // "top right bottom left" in pixels

  // Exclusive: Reserve space (prevent windows from covering bar)
  // "exclusive": true,

  // --------------------------------------------------------------------------
  // Module Layout
  // --------------------------------------------------------------------------
  // Define which modules appear where on the bar
  // Available modules: https://github.com/Alexays/Waybar/wiki/Module:-Custom

  "modules-left": [
    "hyprland/workspaces",  // Workspace buttons (1-5 + any active)
    "hyprland/window"       // Active window title
  ],

  "modules-center": [
    "clock"  // Date/time with calendar tooltip
  ],

  "modules-right": [
    "tray",         // System tray (Nextcloud, network, bluetooth icons)
    "network",      // Network status and bandwidth
{{ if eq .chassisType "laptop" }}
    "bluetooth",    // Bluetooth control (laptop only)
    "backlight",    // Screen brightness (laptop only)
    "battery",      // Battery status (laptop only)
{{ end }}
    "pulseaudio",       // Volume control
    "mpris",            // Media control (Spotify, VLC, etc.)
    "custom/swaync"     // Notification bell
  ],

  // Additional useful modules (uncomment and add to layout above):
  // "battery"           - Battery status (laptops)
  // "backlight"         - Screen brightness (laptops)
  // "idle_inhibitor"    - Prevent auto-sleep
  // "mpd"               - Music Player Daemon
  // "disk"              - Disk usage
  // "custom/weather"    - Custom weather script

  // --------------------------------------------------------------------------
  // Hyprland Workspaces Module
  // --------------------------------------------------------------------------
  "hyprland/workspaces": {
    // Format: How workspace buttons are displayed
    //   {icon}  = Use format-icons below
    //   {name}  = Workspace name
    //   {id}    = Workspace number
    "format": "{icon}",

    // Icons for different workspace states (Omarchy-style)
    //   active:   Workspace focused on THIS monitor
    //   visible:  Workspace focused on OTHER monitor (visible elsewhere)
    //   default:  Has windows but not focused
    //   empty:    Empty persistent workspace
    //   urgent:   Workspace needs attention
    "format-icons": {
      "urgent":  "ÔÅ™",              // Warning triangle
      "active":  "Û∞∫ï",              // Double circle (active on this monitor)
      "visible": "ÔÜí",              // Ring (active on other monitor)
      "default": "ÔÑå",              // Hollow circle (has windows)
      "empty":   "¬∑"                // Dot (empty persistent)
    },

    // No persistent workspaces

    // Per-monitor configuration (only show workspaces for current monitor)
    "all-outputs": false,
    "sort-by-coordinates": true,
    "disable-scroll": true,

    // Click behavior (activate workspace on current monitor)
    "on-click": "activate"
  },

  // --------------------------------------------------------------------------
  // Hyprland Window Module
  // --------------------------------------------------------------------------
  "hyprland/window": {
    // Format: How window title is displayed
    //   {}      = Window title
    //   {title} = Window title (explicit)
    //   {class} = Window class
    "format": "{}",

    // Max length: Truncate long titles (in characters)
    "max-length": 50

    // Separate outputs: Only show title from focused monitor
    // "separate-outputs": true,

    // Rewrite rules: Transform window titles (uncomment to use)
    // "rewrite": {
    //   "(.*) ‚Äî Mozilla Firefox": "üåé $1",
    //   "(.*) - kitty": "  $1"
    // }
  },

  // --------------------------------------------------------------------------
  // Clock Module
  // --------------------------------------------------------------------------
  "clock": {
    // Format: Date/time display (strftime format)
    //   %A = Full weekday name (Monday)
    //   %H = Hour 24-hour (00-23)
    //   %M = Minute (00-59)
    //   Common formats:
    //     "%H:%M"           = 14:30
    //     "%I:%M %p"        = 02:30 PM
    //     "%Y-%m-%d %H:%M"  = 2025-10-10 14:30
    "format": "{:%A %H:%M}",

    // Alternate format: Click to toggle between main and alt
    "format-alt": "{:%Y-%m-%d %H:%M:%S}"

    // Additional options (uncomment to use):
    // "tooltip-format": "<tt><small>{calendar}</small></tt>",
    // "interval": 60,              // Update interval in seconds
    // "timezone": "America/New_York",
    // "locale": "fr_FR.UTF-8"
  },



  // --------------------------------------------------------------------------
  // Network Module
  // --------------------------------------------------------------------------
  "network": {
    // Icons for different signal strengths (WiFi)
    "format-icons": ["Û∞§Ø", "Û∞§ü", "Û∞§¢", "Û∞§•", "Û∞§®"],

    // Default format (auto-detects connection type)
    "format": "{icon}",

    // WiFi format
    "format-wifi": "{icon}",

    // Ethernet format: Û∞àÄ = Ethernet icon (Material Design)
    "format-ethernet": "Û∞àÄ",

    // Disconnected format: Û∞ñ™ = No connection icon (Material Design)
    "format-disconnected": "Û∞ñ™",

    // Alternate format: Show IP address
    "format-alt": "{ipaddr}/{cidr}",

    // Enhanced tooltips with technical details
    "tooltip-format-wifi": "{essid} ({frequency} GHz)\n{ipaddr}/{cidr} Ôûñ {gwaddr}\n‚á£{bandwidthDownBytes} ‚á°{bandwidthUpBytes}",
    "tooltip-format-ethernet": "Ethernet\n{ipaddr}/{cidr} Ôûñ {gwaddr}\n‚á£{bandwidthDownBytes} ‚á°{bandwidthUpBytes}",
    "tooltip-format-disconnected": "Disconnected\nNo network interface available",

    // Update interval for bandwidth (seconds) - optimized for network monitoring
    "interval": 5,

    // Icon spacing
    "spacing": 1,

    // Multi-click actions
    "on-click": "ghostty --class=network-manager -e nmtui",      // Left-click: NetworkManager TUI
    "on-click-right": "networkctl status",                       // Right-click: Network status
    "on-click-middle": "nmcli connection reload"                 // Middle-click: Reload connections
  },

  // --------------------------------------------------------------------------
  // PulseAudio Module
  // --------------------------------------------------------------------------
  "pulseaudio": {
    // Format:
    //   {icon}   = Volume icon (from format-icons below)
    //   {volume} = Volume percentage (0-100)
    "format": "{icon} {volume}%",
    
    // Bluetooth format with device-specific icons
    "format-bluetooth": "{icon} {volume}%",
    "format-bluetooth-muted": "Û∞ùü",
    
    // Muted format: Û∞ùü = Muted icon (Material Design)
    "format-muted": "Û∞ùü",
    
    // Icons: Different icons based on volume level and device type
    "format-icons": {
      "headphone": "Û∞ãã",      // Headphones (Material Design)
      "headset": "Û∞ãé",        // Headset (Material Design)
      "default": [
        "Û∞ïø",                // Low volume (Material Design)
        "Û∞ñÄ",                // Medium volume (Material Design)
        "Û∞ïæ"                 // High volume (Material Design)
      ]
    },
    
    // Enhanced tooltip with device information
    "tooltip-format": "{sink_desc}\nVolume: {volume}%\n{format_source}",
    
    // Conditional execution: Only load if pamixer is available
    "exec-if": "which pamixer",
    
    // Multi-click actions
    "on-click": "pavucontrol",                    // Left-click: Volume control GUI
    "on-click-right": "pamixer -t",               // Right-click: Toggle mute
    "on-click-middle": "pamixer --next-sink",     // Middle-click: Next audio sink
    
    // Scroll actions: Fine-grained volume control
    "on-scroll-up": "pamixer -i 5",
    "on-scroll-down": "pamixer -d 5",

    // Additional options (uncomment to use):
    // "max-volume": 150,                // Allow volume above 100%
    // "ignored-sinks": ["Easy Effects Sink"]  // Don't show these sinks
  },

  // --------------------------------------------------------------------------
  // MPRIS Module (Media Control)
  // --------------------------------------------------------------------------
  "mpris": {
    // Player selection: Use playerctld for automatic focus management
    // playerctld automatically focuses the most recently active player
    "player": "playerctld",

    // Ignore browser-based players to reduce noise
    // This prevents YouTube, Soundcloud, etc. from interfering with Spotify
    "ignored-players": ["firefox", "chromium"],

    // Format: Playing state (bold for emphasis)
    // Example output: Û∞êä Never Gonna Give You Up - Rick Astley
    "format-playing": "<b>{status_icon} {dynamic}</b>",

    // Format: Paused state (italic, less emphasis)
    // Example output: Û∞è§ Never Gonna Give You Up - Rick Astley
    "format-paused": "{status_icon} <i>{dynamic}</i>",

    // Format: Stopped state (icon only, minimal presence)
    // Example output: Û∞ìõ
    "format-stopped": "{status_icon}",

    // Dynamic content configuration
    // {dynamic} auto-populates from available metadata
    "dynamic-order": ["title", "artist"],  // Show title first, then artist
    "dynamic-separator": " - ",            // Separator between title and artist
    "dynamic-len": 35,                     // Maximum total length (prevents overflow)
    "ellipsis": "‚Ä¶",                       // Unicode ellipsis for truncation

    // Status icons (Material Design Nerd Font icons)
    "status-icons": {
      "playing": "Û∞êä",    // Play icon (filled circle with triangle)
      "paused": "Û∞è§",     // Pause icon (two vertical bars)
      "stopped": "Û∞ìõ"     // Stop icon (filled square)
    },

    // Enhanced tooltips with full track metadata
    "tooltip-format-playing": "{player} (Playing)\n{title}\n{artist} - {album}\n{position}/{length}",
    "tooltip-format-paused": "{player} (Paused)\n{title}\n{artist} - {album}",
    "tooltip-format-stopped": "{player} (Stopped)",

    // Conditional execution: Only load if playerctl is available
    "exec-if": "which playerctl",

    // Multi-click actions (standard media controls)
    "on-click": "playerctl play-pause",           // Left-click: Toggle play/pause
    "on-click-right": "playerctl next",           // Right-click: Next track
    "on-click-middle": "playerctl previous",      // Middle-click: Previous track

    // Scroll actions: Volume control (5% increments)
    // Complements pulseaudio volume control
    "on-scroll-up": "playerctl volume 0.05+",     // Scroll up: +5% volume
    "on-scroll-down": "playerctl volume 0.05-"    // Scroll down: -5% volume
  },

  // --------------------------------------------------------------------------
  // System Tray Module
  // --------------------------------------------------------------------------
  "tray": {
    // Icon size in pixels
    "icon-size": 16,

    // Spacing between tray icons in pixels
    "spacing": 8

    // Additional options (uncomment to use):
    // "show-passive-items": false,  // Hide passive tray items
    // "reverse-direction": false,   // Reverse icon order
    // "on-click-middle": "none"     // Middle-click action
  },

  // --------------------------------------------------------------------------
  // Notification Bell (swaync)
  // --------------------------------------------------------------------------
  // swaync-client -swb  ‚Üí persistent JSON subscriber (text=count, alt=state)
  // States: notification | none | dnd-notification | dnd-none
  "custom/swaync": {
    "return-type": "json",
    "exec": "swaync-client -swb",
    "exec-persistent": true,
    "format": "{icon}{text}",
    "format-icons": {
      "notification":     "Û∞Çö",
      "none":             "Û∞Çú",
      "dnd-notification": "Û∞Çõ",
      "dnd-none":         "Û∞™ë"
    },
    "tooltip": true,
    "escape": true,
    "on-click":        "swaync-client -t -sw",
    "on-click-right":  "swaync-client -d -sw",
    "on-click-middle": "swaync-client -c -sw"
  },

  // ==========================================================================
  // Laptop-Specific Modules (bluetooth, battery, backlight)
  // ==========================================================================
{{ if eq .chassisType "laptop" }}
  // Bluetooth module: Device management and status
  "bluetooth": {
    // Conditional execution: Only load if blueman-manager is available
    "exec-if": "which blueman-manager",
    
    // Format: Icon when bluetooth enabled
    "format": "Û∞ÇØ",

    // Format when bluetooth disabled
    "format-disabled": "Û∞Ç≤",

    // Format when devices connected (with count)
    "format-connected": " {num_connections}",

    // Format with battery level for connected devices
    "format-connected-battery": "{icon} {num_connections}",

    // Battery level icons (0-100% in 10% increments)
    "format-icons": ["Û∞•á", "Û∞§æ", "Û∞§ø", "Û∞•Ä", "Û∞•Å", "Û∞•Ç", "Û∞•É", "Û∞•Ñ", "Û∞•Ö", "Û∞•Ü", "Û∞•à"],

    // Tooltip: Controller info
    "tooltip-format": "{controller_alias}\t{controller_address}\n{num_connections} connected",

    // Tooltip when devices connected: Show device list
    "tooltip-format-connected": "{controller_alias}\t{controller_address}\n{num_connections} connected\n\n{device_enumerate}",
    "tooltip-format-enumerate-connected": "{device_alias}\t{device_address}",
    "tooltip-format-enumerate-connected-battery": "{device_alias}\t{device_address}\t{icon} {device_battery_percentage}%",

    // Click action: Open bluetooth manager GUI
    "on-click": "blueman-manager"
  },

  // Battery module (for laptops):
  "battery": {
    // Warning thresholds
    "states": {
      "good": 100,
      "warning": 30,
      "critical": 10
    },

    // Format: Icon + percentage
    "format": "{icon} {capacity}%",

    // Format when charging (Material Design icons)
    "format-charging": "Û∞¢ú {capacity}%",
    "format-charging-full": "Û∞Çã {capacity}%",
    
    // Format when plugged (full)
    "format-plugged": "Û∞ö• {capacity}%",
    
    // Alternate format: Show time remaining
    "format-alt": "{icon} {time}",
    
    // Format when full
    "format-full": "Û∞Åπ {capacity}%",

    // Battery level icons (Material Design 10-level progression)
    "format-icons": [
      "Û∞Å∫", "Û∞Åª", "Û∞Åº", "Û∞ÅΩ", "Û∞Åæ", "Û∞Åø", "Û∞ÇÄ", "Û∞ÇÅ", "Û∞ÇÇ", "Û∞ÇÉ", "Û∞Åπ"
    ],
    
    // Update interval for responsive monitoring - optimized for battery
    "interval": 3,

    // Enhanced tooltip with technical details
    "tooltip-format": "{timeTo}\n{capacity}% - {power}W\nHealth: {health}%",
    
    // Multi-click actions
    "on-click": "powerprofilesctl",               // Left-click: Power profile selector
    "on-click-right": "echo 'Battery info: $(upower -i $(upower -e | grep BAT) | grep -E \"percentage|state|time to empty\")' | xargs -0 notify-send"  // Right-click: Battery info notification
  },

  // Backlight module (screen brightness for laptops):
  "backlight": {
    // Conditional execution: Only load if light command is available
    "exec-if": "which light",
    
    // Format: Icon + percentage
    "format": "{icon} {percent}%",

    // Brightness level icons (9-level progression from empty to full) - keeping current icons as requested
    "format-icons": [
      "Óéç", "Óèì", "Óèë", "Óèè", "Óèé", "Óèç", "Óèä", "Óèà", "Óéõ"
    ],

    // Scroll actions: Fine-grained brightness control (1% adjustments)
    "on-scroll-up": "light -A 1",
    "on-scroll-down": "light -U 1",
    
    // Multi-click actions
    "on-click": "light -S 25",                    // Left-click: 25% brightness
    "on-click-right": "light -S 75",              // Right-click: 75% brightness
    "on-click-middle": "light -S 50",             // Middle-click: 50% brightness
    
    // Update interval for responsive feedback
    "interval": 2
  },
{{ end }}
}
