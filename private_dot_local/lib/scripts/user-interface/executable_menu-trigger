#!/usr/bin/env sh

# Script: menu-trigger
# Purpose: Trigger menu (Capture/Share/Toggle quick actions)
# Requirements: Arch Linux, wofi

# Source helpers
. "$SCRIPTS_DIR/user-interface/menu-helpers.sh"

# Main trigger menu - Using Material Design icons
MAIN_OPTIONS="󰁍 Back|󰄀 Capture|󰅟 Clipboard|󰒖 Share|󰔡 Toggle"
CHOICE=$(show_menu "Trigger" "$MAIN_OPTIONS")

case "$CHOICE" in
    "󰁍 Back")
        "$SCRIPTS_DIR/user-interface/system-menu"
        ;;
    "󰄀 Capture")
        # Capture submenu
        CAPTURE_OPTIONS="󰁍 Back|󰹑 Screenshot (Smart)|󰩭 Screenshot (Region)|󰖲 Screenshot (Window)|󰍹 Screenshot (Fullscreen)|󰨸 Screenshot → Clipboard|󰻂 Screen Record|󰕾 Screen Record + Audio|󰴱 Color Picker"
        CAPTURE_CHOICE=$(show_menu "Capture" "$CAPTURE_OPTIONS")

        case "$CAPTURE_CHOICE" in
            "󰁍 Back")
                "$SCRIPTS_DIR/user-interface/menu-trigger"
                ;;
            "󰹑 Screenshot (Smart)")
                "$SCRIPTS_DIR/media/screenshot" smart
                ;;
            "󰩭 Screenshot (Region)")
                "$SCRIPTS_DIR/media/screenshot" region
                ;;
            "󰖲 Screenshot (Window)")
                "$SCRIPTS_DIR/media/screenshot" windows
                ;;
            "󰍹 Screenshot (Fullscreen)")
                "$SCRIPTS_DIR/media/screenshot" fullscreen
                ;;
            "󰨸 Screenshot → Clipboard")
                "$SCRIPTS_DIR/media/screenshot" smart clipboard
                ;;
            "󰻂 Screen Record")
                "$SCRIPTS_DIR/desktop/screenrecord"
                ;;
            "󰕾 Screen Record + Audio")
                "$SCRIPTS_DIR/desktop/screenrecord" --with-audio
                ;;
            "󰴱 Color Picker")
                pkill hyprpicker || hyprpicker -a
                ;;
        esac
        ;;
    "󰅟 Clipboard")
        CLIP_OPTIONS="󰁍 Back|󰅟 Clipboard History|󰅢 Clear Clipboard"
        CLIP_CHOICE=$(show_menu "Clipboard" "$CLIP_OPTIONS")
        case "$CLIP_CHOICE" in
            "󰁍 Back") "$SCRIPTS_DIR/user-interface/menu-trigger" ;;
            "󰅟 Clipboard History") cliphist list | wofi --dmenu | cliphist decode | wl-copy ;;
            "󰅢 Clear Clipboard") cliphist wipe && notify "󰅟 Clipboard" "History cleared" ;;
        esac ;;
    "󰒖 Share")
        # Share submenu (placeholder for future file sharing)
        SHARE_OPTIONS="󰁍 Back|󰈔 Share File"
        SHARE_CHOICE=$(show_menu "Share" "$SHARE_OPTIONS")

        case "$SHARE_CHOICE" in
            "󰁍 Back")
                "$SCRIPTS_DIR/user-interface/menu-trigger"
                ;;
            "󰈔 Share File")
                notify "󰒖 Share" "File sharing not yet implemented"
                ;;
        esac
        ;;
    "󰔡 Toggle")
        # Toggle submenu
        TOGGLE_OPTIONS="󰁍 Back|󰛨 Nightlight|󰌾 Idle Lock|󰘯 Waybar|󰝘 Workspace Gaps"
        TOGGLE_CHOICE=$(show_menu "Toggle" "$TOGGLE_OPTIONS")

        case "$TOGGLE_CHOICE" in
            "󰁍 Back")
                "$SCRIPTS_DIR/user-interface/menu-trigger"
                ;;
            "󰛨 Nightlight")
                "$SCRIPTS_DIR/desktop/nightlight-toggle"
                ;;
            "󰌾 Idle Lock")
                "$SCRIPTS_DIR/desktop/idle-toggle"
                ;;
            "󰘯 Waybar")
                "$SCRIPTS_DIR/desktop/waybar-toggle"
                ;;
            "󰝘 Workspace Gaps")
                "$SCRIPTS_DIR/desktop/workspace-gaps-toggle"
                ;;
        esac
        ;;
esac
