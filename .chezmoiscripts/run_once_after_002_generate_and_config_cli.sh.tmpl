#!/bin/sh
# Chezmoi orchestrator for CLI configuration

{{- template "chezmoi_logger_setup" . }}

{{ if eq .osId "linux-arch" }}
    
    log_step "Preparing environment for CLI configuration"
    
    # All standard environment variables are now exported by chezmoi_logger_setup
    # No additional exports needed for this script
    
    # Determine script path
    SCRIPT_PATH="${CHEZMOI_SOURCE_DIR}/.chezmoiscripts/.lib/development/configure-cli.sh"
    
    log_info "Executing: $(basename "$SCRIPT_PATH")"
    
    # Execute with error handling
    if [ -x "$SCRIPT_PATH" ]; then
        if ! "$SCRIPT_PATH"; then
            handle_error "CLI configuration failed: $(basename "$SCRIPT_PATH")" $?
        fi
    else
        log_error "Script not found or not executable: $SCRIPT_PATH"
        exit 1
    fi
    
    log_success "CLI configuration completed successfully"
    
{{ else }}
    log_error "Unsupported OS: {{ .osId }}"
    log_error "This script requires: linux-arch"
    exit 1
{{ end }}
