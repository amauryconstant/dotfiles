#!/bin/sh

# Script: run_once_after_002_generate_and_config_cli.sh.tmpl
# Purpose: Generate tldr manuals and configure Docker permissions
# Requirements: Linux

{{ if eq .chezmoi.os "linux" }}

    # Generate tldr manuals
    tldr --gen-config > "$(tldr --config-path)"

    # Grant $USER docker permissions 
    if ! id -nG "$USER" | grep -qw "docker"; then
        sudo groupadd docker
        sudo usermod -aG docker $USER
        newgrp docker
    fi

{{ else }}
    echo "ERROR: This script is only supported on Linux systems"
    echo "Required: OS 'linux'"
    echo "Detected: '{{ .chezmoi.os }}'"
    echo "Script: $(basename "$0")"
    exit 1
{{ end }}
