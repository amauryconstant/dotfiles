#!/bin/sh

# Script: run_once_before_003_write_globals.sh.tmpl
# Purpose: Write global environment variables to shell profile
# Requirements: Linux

{{ includeTemplate "log_step" "Setting up global environment variables..." }}

# Create the environment file
GLOBALS_FILE="$HOME/.config/environment.d/chezmoi-globals.conf"

# Create directory if it doesn't exist
mkdir -p "$(dirname "$GLOBALS_FILE")"

# Write global variables
cat > "$GLOBALS_FILE" << 'EOF'
# Global environment variables managed by chezmoi
{{- range $key, $value := .globals.linux }}
{{ $key }}={{ $value | replace "HOME" "$HOME" }}
{{- end }}
EOF

{{ includeTemplate "log_success" "Global environment variables written to $GLOBALS_FILE" }}
